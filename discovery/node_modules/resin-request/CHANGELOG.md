# Change Log

All notable changes to this project will be documented in this file
automatically by Versionist. DO NOT EDIT THIS FILE MANUALLY!
This project adheres to [Semantic Versioning](http://semver.org/).

## v9.1.0 - 2018-06-12

* Return the whole body when having a non-object error property #114 [Thodoris Greasidis]

## v9.0.3 - 2018-04-25

* Update jsdoc-to-markdown to fix #110 #112 [Tim Perry]

## v9.0.2 - 2017-11-22

* Set up circleci npm autopublishing #109 [Tim Perry]

## v9.0.1 - 2017-11-01

* Reformat changelog to add versionbot #108 [Tim Perry]

## v9.0.0 - 2017-10-31

- Using resin-auth instead of resin-token

## v8.6.0 - 2017-10-05

- Allow requests to be sent without a token using `sendToken: false`, even if one exists

## v8.5.0 - 2017-07-07

### Changed

- Added the new `responseFormat` option to `send` to define the explicit response body format
- Added proxy support tests

### Fixed

- Fix bug with token error handling when code is minified

## v8.4.0 - 2017-04-10

- Stopped trying to resolve the token if none is provided
- Updated rindle so that bluebird and lodash can be deduped
- Removed unused `resin-token` import, so that it's possible to use the module with api keys without installing `resin-token`

## v8.3.1 - 2017-04-03

- Peer depend on resin-token 4.0.0

## v8.3.0 - 2017-02-23

- Include request config in errors from failed requests
- Don't add `accept-encoding` in browsers by default (since it doesn't work)

## v8.2.0 - 2017-02-20

- Added request interception support.

## v8.1.0 - 2017-01-06

### Changed

- Internal refactoring of mocking the fetch requests. New `getRequest._setFetch` method added.

## v8.0.1 - 2017-01-04

### Changed

- **Breaking:** Resin-Token must now be injected, rather than being built internally
- Fixed bug where no timeouts were set
- Timeouts now abort underlying requests (in Node only)

## 8.0.0 (yanked due to major issues)

## v7.0.0 - 2017-01-02

### Changed

- **Breaking:** Timeouts in requests now use the Bluebird implementation. This changes how errors are thrown slightly: a `Promise.TimeoutError` is now thrown instead of a raw `Error`, with the message "operation timed out" instead of "timeout".
- Fetch is now provided internally (by `Fetch-ponyfill`), so isomorphic-fetch is no longer required in downstream applications.

## v6.2.0 - 2016-12-13

### Changed

- Include 'duration' in debug output, if enabled
- Added a 'retries' option you can pass to `send()`, to set the number of times to retry
failing requests, or to `getRequest` directly to set the default number of retries.

## v6.1.1 - 2016-12-13

### Changed

- **Fixed:** in specific environments (like Chrome 54) `Response.body` is a getter that is
impossible to overwrite. As a result it's always the original instance of the ReadableStream.
We now clone the response object before assigning the parsed body.

## v6.1.0 - 2016-12-13

### Changed

- Lazy-load the dependencies that are not used by the browser code.

## v6.0.1 - 2016-11-24

### Changed

- Added the missing `qs` dependency.

## v6.0.0 - 2016-11-20

### Changed

- **Breaking!** Switch to factory pattern in order to make it work with the new resin-token
- Fix the `apikey` query param name

## v5.0.0 - 2016-09-15

### Changed

- Updated `resin-token` to v2.4.3
- Run tests in the browser
- Updated node versions to be run on Travis and AppVeyor
- **Breaking!** Take API Key as a query option
- **Breaking!** Decouple resin-request from resin-settings-client

## v4.1.2 - 2016-03-17

### Changed

- Ensure query strings are not encoded when passing an `api_key`.

## v4.1.1 - 2016-03-14

### Changed

- Prevent passing an undefined `api_key` query string.

## v4.1.0 - 2016-03-13

### Added

- Add API key support via `RESIN_API_KEY`.

## v4.0.7 - 2016-03-09

### Changed

- Upgrade dependencies.
- Fix README example indentation.

## v4.0.6 - 2016-03-09

### Changed

- Remove token if its expired.

## v4.0.5 - 2016-03-03

### Changed

- Throw `ResinExpiredToken` if there is a saved token but its expired.

## v4.0.4 - 2016-02-18

### Added

- Show debug information when passing `DEBUG=true`.

### Changed

- Only set a timeout default on non-streaming HTTP requests.

## v4.0.3 - 2016-02-17

### Changed

- Set a default timeout of 30 seconds.

## v4.0.2 - 2016-02-12

### Changed

- Support `baseUrl` option.

## v4.0.1 - 2016-01-24

### Changed

- Add `statusCode` property to `ResinRequestError` instances.

## v4.0.0 - 2016-01-20

### Removed

- Remove custom stream `.length` property.

## 3.0.0 (yanked due to major issues)

## v2.4.3 - 2016-01-20

### Changed

- Make sure we send an `Accept-Encoding` header on streaming requests.
- Only disable `gzip` on streaming requests.
- Enable `strictSSL` by default.
- Change license to Apache 2.0.
- Fix `X-Transfer-Length` header not being interpreted correctly.

## v2.4.2 - 2016-01-08

### Changed

- Fix `X-Transfer-Length` decompression bug.

## v2.4.1 - 2015-11-23

### Changed

- Fix compressed/uncompressed data piping bug.

## v2.4.0 - 2015-11-17

### Added

- Fallback to `X-Transfer-Length` if no `Content-Length`.

## v2.3.2 - 2015-09-07

### Changed

- Upgrade `resin-settings-client` to v3.0.0.

## v2.3.1 - 2015-08-26

### Changed

- Translate `percent` to `percentage` in progress event.

## v2.3.0 - 2015-08-25

### Added

- Implement stream custom `.mime` property.

### Changed

- Document stream custom `.length` property.

## v2.2.5 - 2015-08-24

### Changed

- Use response `Content-Length` to determine stream `length`.

## v2.2.4 - 2015-08-24

### Changed

- Fix random error when piping a stream.

## v2.2.3 - 2015-08-07

### Changed

- Fix unit tests in Appveyor.
- Upgrade `resin-token` to v2.4.1.

## v2.2.2 - 2015-07-27

### Changed

- Prevent Authorization header from being undefined, which resulted on an exception in `request@2.53.0`.

## v2.2.1 - 2015-07-17

### Changed

- Use `tokenRefreshInterval` setting instead of `tokenValidityTime`, to decide if it's time to refresh the token.

## v2.2.0 - 2015-07-17

### Added

- Add `eta` property to progress state.
- Refresh session token at an interval.

## v2.1.0 - 2015-06-29

### Added

- Reject `request.stream()` with the request body if response status code doesn't determine a success.

### Changed

- Upgrade `resin-token`, which now stops validating a token with the server.

## v2.0.0 - 2015-06-18

### Added

- JSDoc documentation.
- License to every source files.
- Implement `request.stream()`.

### Changed

- Support promises.
- Improved README documentation.
- Rename `request()` to `send()`.

## v1.3.0 - 2015-06-12

### Changed

- Move `onProgress` callback to `options` object.

## v1.2.5 - 2015-05-18

### Changed

- Upgrade Resin Settings Client to v1.0.1, which defaults remoteUrl to api.resin.io.

## v1.2.4 - 2015-05-07

### Changed

- Fix pipe issue.

## v1.2.3 - 2015-04-21

### Changed

- Print node-request progress state on `DEBUG`.

### Added

- Configure Hound CI correctly.

## v1.2.2 - 2015-03-20

### Added

- Print request method on `DEBUG`.

## v1.2.1 - 2015-03-20

### Added

- Improve error logging support.
- Implement `DEBUG` flag.

## v1.2.0 - 2015-03-19

### Changed

- Make use of [resin-settings-client](https://github.com/resin-io-modules/resin-settings-client) to retrieve `options.remoteUrl`.

## v1.1.0 - 2015-03-18

### Removed

- `options.token` option is now obsolete, as the token is fetched automatically with [resin-token](https://github.com/resin-io-modules/resin-token).
